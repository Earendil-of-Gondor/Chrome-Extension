<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.0.1/firebase-analytics.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.0.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD2iKakYgBqJ2T6CVQpzHZIjzJW8k0JQTo",
            authDomain: "test-e7bb0.firebaseapp.com",
            projectId: "test-e7bb0",
            storageBucket: "test-e7bb0.appspot.com",
            messagingSenderId: "84428320764",
            appId: "1:84428320764:web:26669d7f6e21cae5650c79",
            measurementId: "G-LM6FVJF8S6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        $(async () => {
            updateUserList()
            $('#userDataSubmit').click(async () => {
                try {
                    const docRef = await addDoc(collection(db, "users"), {
                        name: $('#nameInput').val(),
                        password: $('#passwordInput').val(),
                    });
                    $('#nameInput').val('');
                    $('#passwordInput').val('');
                    updateUserList()
                } catch (e) {
                    console.error("Error adding document: ", e);
                }
            });

        })

        async function updateUserList() {
            const querySnapshot = await getDocs(collection(db, "users"));
            $('#users').empty()
            querySnapshot.forEach((doc) => {
                $('#users').append('<p>' + (doc.data().name) + '</p>')
            });
        }


    </script>
</head>

<body>
    <h1>User Database</h1>
    <input type="text" placeholder="Name" id="nameInput">
    <input type="text" placeholder="Password" id="passwordInput">
    <button id="userDataSubmit">Submit</button>
    <ul id="users">

    </ul>
</body>

</html>